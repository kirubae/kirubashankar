---
import BaseLayout from '@layouts/BaseLayout.astro';

export const prerender = false;

const supabaseUrl = import.meta.env.PUBLIC_SUPABASE_URL || '';
const supabaseKey = import.meta.env.PUBLIC_SUPABASE_ANON_KEY || '';
---

<BaseLayout title="Logging out...">
  <div class="logout-container">
    <div class="spinner"></div>
    <p>Logging out...</p>
  </div>
</BaseLayout>

<script is:inline src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script is:inline define:vars={{ supabaseUrl, supabaseKey }}>
  (function() {
    try {
      var supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
      supabase.auth.signOut().finally(function() {
        window.location.href = '/';
      });
    } catch(e) {
      console.error('Logout error:', e);
      window.location.href = '/';
    }
  })();
</script>

<style>
  .logout-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 50vh;
    gap: 16px;
  }

  .logout-container p {
    color: var(--color-ink-light);
    font-size: 14px;
  }

  .spinner {
    width: 32px;
    height: 32px;
    border: 3px solid var(--color-border);
    border-top-color: var(--color-ink);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }
</style>
